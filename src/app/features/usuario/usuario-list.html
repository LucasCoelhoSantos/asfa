<app-main-menu></app-main-menu>

<div class="usuarios-list-container">
  <!-- Header Section -->
  <div class="header-section">
    <div class="header-content">
      <h1>Usu√°rios do Sistema</h1>
      <p class="subtitle">Gerencie os usu√°rios e permiss√µes do sistema</p>
    </div>
    <button class="btn-add" (click)="navigate('/usuario/novo')">
      Adicionar Usu√°rio
    </button>
  </div>

  <!-- Content Section -->
  <div class="content-section">
    <!-- Loading State -->
    <div class="loading-state" *ngIf="(usuarios$ | async) === null">
      <div class="loading-spinner"></div>
      <p>Carregando usu√°rios...</p>
    </div>

    <!-- Users Table -->
    <div class="table-container" *ngIf="(usuarios$ | async) as usuarios">
      <div class="table-header">
        <div class="table-info">
          <span class="users-count">{{ usuarios.length }} usu√°rio{{ usuarios.length !== 1 ? 's' : '' }}</span>
        </div>
      </div>

      <div class="table-wrapper">
        <table class="users-table">
          <thead>
            <tr>
              <th class="th-name">Nome</th>
              <th class="th-email">Email</th>
              <th class="th-role">Papel</th>
              <th class="th-status">Status</th>
              <th class="th-actions">A√ß√µes</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let usuario of usuarios" class="user-row">
              <td class="td-name">
                <div class="user-info">
                  <div class="user-avatar">
                    <span class="avatar-text">{{ getUserInitials(usuario.email) }}</span>
                  </div>
                  <div class="user-details">
                    <span class="user-name">{{ usuario.nome }}</span>
                    <span class="user-email">{{ usuario.email }}</span>
                  </div>
                </div>
              </td>
              <td class="td-email">
                <span class="email-text">{{ usuario.email }}</span>
              </td>
              <td class="td-role">
                <span class="role-badge" [class.admin]="usuario.role === 'admin'">
                  <span class="role-icon">{{ usuario.role === 'admin' ? 'üëë' : 'üë§' }}</span>
                  {{ usuario.role === 'admin' ? 'Admin' : 'Usu√°rio' }}
                </span>
              </td>
              <td class="td-status">
                <span class="status-badge" [class.ativo]="usuario.ativo" [class.inativo]="!usuario.ativo">
                  <span class="status-dot"></span>
                  {{ usuario.ativo ? 'Ativo' : 'Inativo' }}
                </span>
              </td>
              <td class="td-actions">
                <div class="actions-group">
                  <button class="btn-action btn-edit" (click)="editar(usuario.id)" title="Editar usu√°rio">
                    <span class="icon">‚úèÔ∏è</span>
                    <span class="action-text">Editar</span>
                  </button>
                  
                  <button *ngIf="!usuario.ativo" 
                          class="btn-action btn-activate" 
                          (click)="ativar(usuario.id)" 
                          title="Ativar usu√°rio">
                    <span class="icon">‚úÖ</span>
                    <span class="action-text">Ativar</span>
                  </button>
                  
                  <button *ngIf="usuario.ativo" 
                          class="btn-action btn-deactivate" 
                          (click)="desativar(usuario.id)" 
                          title="Desativar usu√°rio">
                    <span class="icon">‚è∏Ô∏è</span>
                    <span class="action-text">Desativar</span>
                  </button>
                  
                  <button class="btn-action btn-remove" 
                          (click)="confirmarRemover(usuario.id)" 
                          title="Remover usu√°rio">
                    <span class="icon">üóëÔ∏è</span>
                    <span class="action-text">Remover</span>
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Empty State -->
      <div class="empty-state" *ngIf="usuarios.length === 0">
        <div class="empty-icon">üë•</div>
        <h3>Nenhum usu√°rio cadastrado</h3>
        <p>Comece adicionando o primeiro usu√°rio ao sistema</p>
        <button class="btn-add-empty" (click)="navigate('/usuario/novo')">
          <span class="icon">‚ûï</span>
          Adicionar Primeiro Usu√°rio
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Remove Confirmation Modal -->
<app-modal
  [show]="showRemoveModal"
  title="Remover Usu√°rio"
  message="Tem certeza que deseja remover este usu√°rio? Esta a√ß√£o n√£o pode ser desfeita."
  confirmText="Remover"
  cancelText="Cancelar"
  (confirm)="remover()"
  (cancel)="cancelarRemover()">
</app-modal>